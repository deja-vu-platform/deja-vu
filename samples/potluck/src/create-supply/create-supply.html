<dv.action name="create-supply" stagedSupply$=dv.merge.object>
  <dv.tx>
    <dv.if condition=$save>
      <dv.status savedText="Supply added to party!" />
    </dv.if>
    <dv.gen-id />

    <div class="row">
      <div class="col-md-12">
        <supply.create-property as potluck-create-supply-item
          name="item" />
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <transfer.create-item-count id=dv.gen-id.id
          showOptionToInputItemId=false
          showOptionToCreate=false
          emitOnRunOnly=true />
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <supply.create-property as potluck-create-supply-unit
          name="unit" />
      </div>
    </div>

    <supply.create-object id=dv.gen-id.id save=$save
      initialValue={
        item: potluck-create-supply-item.value,
        unit: potluck-create-supply-unit.value
      }
      hidden=true />


    <dv.if condition=$save>
      <transfer.add-to-balance accountId=$id
        amount=transfer.create-item-count.itemCountAsAmount
        hidden=true />
    </dv.if>

    <dv.merge sources=[supply.create-object.object,
      transfer.create-item-count.itemCount] />

    <authentication.authenticate id=$loggedInUserId hidden=true />

    <div class="row">
      <div class="col-md-12">
        <dv.button>Add Supply</dv.button>
        <dv.if condition=$save>
          <dv.callback defaultHref="/parties" onExecSuccess=true
            hidden=true />
        </dv.if>
      </div>
    </div>
  </dv.tx>
</dv.action>
