<dv-widget name="NavBar"></dv-widget>

<div id="left-main-div">

  <!-- NOTE: below ngIf conditions will fail if a coordinate is 0 -->
  <!-- however, such a precise click is highly unlikely -->

  <!-- on page load, show a marker pic and tell user to click the map -->
  <dv-widget
    name="AddASpot"
    *ngIf="(!new_spot.lat || !new_spot.lng) && !search_results.arr">
  </dv-widget>

  <!-- once the map is clicked, show the new spot form -->
  <dv-widget
    name="AddASpotForm"
    *ngIf="(new_spot.lat && new_spot.lng) && !search_results.arr">
  </dv-widget>

  <!-- TODO: put this into a widget once params can be passed through -->
  <!-- HACK: change once array fields are supported -->
  <div *ngIf="search_results.arr">
    <div
      *ngFor="let result of search_results.arr"
      class="panel panel-default resultPanel"
    >
      <div class="panel-heading">
        <h4>
          <!-- HACK: need separate widget to use dvLink -->
          <a
            [routerLink]="['/spots']"
            [queryParams]="{spot: result.atom_id+',Spot'}"
          >
            {{result.name}}
          </a>
        </h4>
      </div>
      <div class="panel-body">
        <dv-widget name="ShowLabels" of="Label" [init]="{item: result}">
        </dv-widget>
        <dv-widget name="ShowAverageRating" of="Rating"
          [init]="{target: result}">
        </dv-widget>
        <dv-widget name="OverlayMarker" of="Map"
          [init]="{marker: result}">
        </dv-widget>
      </div>
    </div>
  </div>
</div>

<div id="map-div">
  <dv-widget name="DisplayMap" of="Map"></dv-widget>
  <dv-widget name="OverlayMarkers" of="Map" *ngIf="!search_results.arr">
  </dv-widget>
</div>
