<!-- Displays a request under My Requests in the dashboard -->
<link rel="stylesheet" href="./components/show-my-request/show-my-request.css">

<div class="col-xs-12 col-ms-6 col-sm-4 col-md-3 col-lg-3">
  <div class="tile request-tile" data-toggle="modal" attr.data-target="#request-modal-{{task.atom_id}}">
    <h4 class="tile-title">{{task.name}}</h4>
    <p class="tile-subtitle">{{task.assignee ? 'Shopper: ' + task.assignee.atom_id : 'unclaimed'}}</p>

    <!-- A request can only be canceled if no one has claimed it yet. -->
    <div *ngIf="!task.assignee">
      <dv-widget name="CancelCompoundTransactionButton" of="Market" [init]="{compoundTransaction: task, submit_ok: submit_ok}"></dv-widget>
      <dv-widget name="CompleteTask" of="Task" style="display: none"></dv-widget>
      <dv-widget name="ApproveTask" of="Task" style="display: none"></dv-widget>
    </div>
  </div>
</div>

<div id="request-modal-{{task.atom_id}}" class="modal fade notif-action-modal request-modal" role="dialog">
  <div class="modal-messages"></div>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h3 class="modal-title">Request Details</h3>
      </div>
      <div class="modal-body">
        <table>
          <tr>
              <th>Item Name</th>
              <td class="item-name">{{task.name}}</td>
          </tr>
          <tr>
              <th>Deadline</th>
              <td class="deadline">{{task.expiration_date}}</td>
          </tr>
          <tr>
            <dv-widget name="ShowCompoundTransaction" of="Market" [init]="{compoundTransaction: task}"></dv-widget>
          </tr>
        </table>
        <div *ngIf="task.assignee">
          <b>Shopper:</b>
          <dv-widget name="ShowContactInformation" of="Profile" [init]="{profile: task.assignee}"></dv-widget>
          <dv-widget name="ShowAverageRating" of="Rating" [init]="{target: task.assignee}"></dv-widget>
        </div>
      </div> <!-- end of modal-body -->  
    </div>
  </div>
</div>
