<dv.action name="create-deliveries">
  <groceryship.navbar accessRequired=true />
  <div class="center-column">
    <dv.group-by items=$requests key="requesterId" hidden=true />
    <dv.pick as pick-keys
             entities=dv.group-by.groupedItems keys=["groupById"]
             newKeyNames=["requesterId"] flatten=false hidden=true />
    <dv.pick as pick-items
             entities=dv.group-by.groupedItems keys=["items"]
             flatten=true hidden=true />
    <dv.tx>
      <dv.gen-ids for=pick-keys.pickedEntities hidden=true />
      <delivery.create-objects initialValue={ delivererId:$requests[0].delivererId }
                               showExclude=["requesterId","delivererId","delivered","confirmed"]
                               ids=dv.gen-ids.ids
                               initialValues=pick-keys.pickedEntities
                               showOptionToSubmit=false
      />
      <request.update-objects objectsToUpdate=pick-items.pickedEntities
                               initialValues={ deliveryId: dv.gen-ids.ids } />
      <dv.button>Confirm</dv.button>
    </dv.tx>

  </div>
</dv.action>
