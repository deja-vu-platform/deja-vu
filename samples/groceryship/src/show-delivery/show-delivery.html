<dv.action name="show-delivery">
  <div class="inline-card">
    <dv.if condition=$isDeliverer >
      Delivering to:
      <authentication.show-user id=$delivery.requesterId />
    </dv.if>
    <dv.if condition=!$isDeliverer >
      Delivering by:
      <authentication.show-user id=$delivery.delivererId/>
    </dv.if>
    Pick Up Time:
    <dv.show-entity entity=$delivery.pickupTime />
    <br />
    Pick Up Location:
    <dv.show-entity entity=$delivery.pickupLocation />

    <mat-expansion-panel class="mat-elevation-z0">
      <mat-expansion-panel-header>
        Items
      </mat-expansion-panel-header>
      <request.show-objects fieldMatching={ deliveryId:$delivery.id }
                            hidden=true
      />
      <dv.table data=request.show-objects.objects
                columnInfo=[{label:"Item Name",fieldName:"itemName"},
      {label:"Quantity",fieldName:"quantity"},
      {label:"Price Estimate",fieldName:"priceEstimate"},
      {label:"Tips",fieldName:"tips"}]
      />
    </mat-expansion-panel>

    <dv.if condition=$isDeliverer && !$delivery.delivered >
      <dv.tx>
        <dv.button>Delivered</dv.button>
        <dv.link href="/input-price" params={ deliveryId:$delivery.id } />
      </dv.tx>

    <!--Status-->
    </dv.if>
    <dv.if condition=$isDeliverer && $delivery.delivered && !$delivery.confirmed >
      Status: Waiting for the requester to confirm
    </dv.if>

    <dv.if condition=!$isDeliverer && !$delivery.delivered >
      Status: the deliverer is on their way
    </dv.if>
    <dv.if condition=!$isDeliverer && $delivery.delivered && !$delivery.confirmed >
      <dv.tx>
        <delivery.update-object as confirm-delivery
                                id=$delivery.id
                                initialValue={confirmed: true}
                                hidden=true />
        <dv.button>Confirm Delivered</dv.button>
      </dv.tx>

    </dv.if>
    <dv.if condition=$delivery.delivered && $delivery.confirmed >
      shouldn't appear
    </dv.if>
    <!--Status Ends-->


  </div>
</dv.action>
